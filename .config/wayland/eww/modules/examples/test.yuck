(defwidget test []
  (box
    :space-evenly false
    (revealer1)
    (revealer2)))

(defvar reveal1 false)
(defvar reveal2 false)
(defvar reveal2-nested false)

; Revealer on hover, using children
(defwidget revealer-on-hover [revealvar revealvar-name transition ?class ?duration]
  (box
    :class "${class} revealer-on-hover"
    :orientation "h"
    :space-evenly false
    (eventbox
      :onhover "${EWW_CMD} update ${revealvar-name}=true"
      :onhoverlost "${EWW_CMD} update ${revealvar-name}=false"
      (box
        :space-evenly false
        (children :nth 0)
        (revealer
          :reveal revealvar
          :transition {transition ?: "slideright"}
          :duration {duration ?: "500ms"}
          (children :nth 1))))))
  
(defwidget revealer1 []
  (revealer-on-hover 
    :revealvar reveal1
    :revealvar-name "reveal1"
    (test-box)
    (box 
      :space-evenly false
      (test-box :color "bg-red")
      (test-box :color "bg-green"))))
 
(defwidget revealer2 []
  (revealer-on-hover 
    :revealvar reveal2
    :revealvar-name "reveal2"
    (test-box)
    (box 
      :space-evenly false
      (test-box :color "bg-red")
      (test-box :color "bg-green")
      (revealer-on-hover 
        :duration "100ms"
        :revealvar reveal2-nested
        :revealvar-name "reveal2-nested"
        (test-box)
        (box 
          :space-evenly false
          (test-box :color "bg-blue")
          (test-box :color "bg-green"))))))
        
(defwidget test-box [?color]
  (box :class "${color} test-box"
    :orientation "h"
    :halign "start"
    :hexpand false
    :space-evenly false
    :width 100))
